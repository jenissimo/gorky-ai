# Gorky AI

Система автоматической генерации художественных книг с использованием LLM (Large Language Models), названная в честь великого русского писателя Максима Горького.

## Описание

Gorky AI представляет собой пайплайн для автоматической генерации художественных книг с использованием языковых моделей. Система разбивает процесс создания книги на логические этапы, начиная от сбора предпочтений пользователя и заканчивая финальной сборкой книги в различных форматах.

## Основные возможности

- Пошаговая генерация книги с возможностью начать с любого этапа
- Сохранение промежуточных результатов
- Поддержка различных LLM-сервисов
- Конвертация в популярные форматы (FB2, HTML)
- Просмотр логов генерации через веб-интерфейс

## Этапы генерации

1. **Предпочтения пользователя**
   - Сбор базовых параметров для генерации
   - Выбор жанра, целевой аудитории, размера книги

2. **Creative Brief**
   - Формирование концепции книги
   - Определение основных тем и конфликтов
   - Описание мира и ключевых локаций

3. **Название книги**
   - Генерация подходящего названия
   - Обоснование выбора названия

4. **Story Outline**
   - Создание общей структуры сюжета
   - Определение ключевых сюжетных точек
   - Планирование арок персонажей

5. **Story Structure**
   - Детальное планирование глав
   - Разбивка на сцены
   - Определение целевого объема текста

6. **Character Sheets**
   - Создание детальных описаний персонажей
   - Проработка мотиваций и конфликтов
   - Определение взаимоотношений

7. **Генерация сцен**
   - Последовательная генерация текста сцен
   - Учет контекста и связности повествования
   - Итеративное редактирование

8. **Финальная сборка**
   - Объединение всех сцен
   - Форматирование текста
   - Конвертация в FB2 и HTML

## Установка

```bash
git clone https://github.com/jenissimo/gorky-ai.git
cd gorky-ai
pip install -r requirements.txt
```

## Использование

### Базовый запуск

```bash
python main.py
```

### Запуск с определенного этапа

```bash
python main.py --stage 3  # Начать с генерации названия
```

### Просмотр логов

В комплекте с Gorky AI поставляется удобный веб-интерфейс для просмотра логов генерации (log_viewer.html):

1. Откройте log_viewer.html в браузере
2. Перетащите файл лога в окно просмотрщика
3. Просматривайте историю взаимодействий с LLM

Log Viewer позволяет:
- Просматривать все запросы к LLM в хронологическом порядке
- Анализировать промпты и ответы
- Отслеживать метаданные каждого запроса
- Исследовать процесс генерации книги

## Структура проекта

```
gorky-ai/
├── main.py              # Основной скрипт
├── workflow/            # Модули этапов генерации
│   ├── book_assembly.py     # Сборка книги
│   ├── chapter_assembly.py  # Сборка глав
│   ├── character_sheet.py   # Генерация персонажей
│   ├── creative_brief.py    # Создание концепции
│   ├── editing.py          # Редактирование текста
│   ├── scene_generation.py  # Генерация сцен
│   ├── story_outline.py    # Структура сюжета
│   ├── story_structure.py  # Детальная структура
│   ├── title_generation.py # Генерация названия
│   └── user_interface.py   # Интерфейс пользователя
├── templates/          # Шаблоны промптов
│   ├── creative_brief.jinja2
│   ├── title_generation.jinja2
│   ├── story_outline.jinja2
│   ├── story_structure.jinja2
│   ├── character_sheet.jinja2
│   ├── scene_generation.jinja2
│   └── editing.jinja2
├── output/            # Результаты генерации
│   ├── book/         # Готовые книги
│   ├── chapters/     # Сгенерированные главы
│   └── iterations/   # Итерации редактирования
├── utils/            # Вспомогательные функции
├── db.py             # Работа с базой данных
├── llm_api.py        # Интеграция с LLM-сервисами
├── log_viewer.html   # Веб-интерфейс просмотра логов
└── WORKFLOW.md       # Детальное описание процесса
```

## Требования

- Python 3.8+
- Доступ к LLM API (поддерживаются различные провайдеры)
- Pandoc (для конвертации в FB2)

## Лицензия

MIT

## Документация

Детальное описание процесса генерации доступно в [WORKFLOW.md](WORKFLOW.md) 